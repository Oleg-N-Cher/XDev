MODULE TestPT3; (*$MAIN*)
IMPORT Asm, B := Basic, Pt3Player;

TYPE Module = ARRAY 2137 OF CHAR;

CONST Ace = Module ( (* http://zxpress.ru/article.php?id=9508 *)
  050X,072X,06FX,054X,072X,061X,063X,06BX,065X,072X,020X,033X,
  02EX,036X,020X,063X,06FX,06DX,070X,069X,06CX,061X,074X,069X,
  06FX,06EX,020X,06FX,066X,020X,061X,063X,065X,020X,020X,020X,
  020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,
  020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,
  020X,020X,020X,062X,079X,020X,053X,063X,06CX,020X,028X,066X,
  06FX,072X,020X,033X,062X,069X,074X,021X,029X,020X,020X,020X,
  020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,020X,
  020X,020X,020X,002X,006X,01BX,01AX,0E5X,000X,000X,000X,000X,
  000X,000X,000X,000X,000X,036X,008X,000X,000X,000X,000X,000X,
  000X,04CX,008X,000X,000X,000X,000X,000X,000X,000X,000X,000X,
  000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,
  000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,
  000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,
  000X,052X,008X,000X,000X,000X,000X,055X,008X,000X,000X,000X,
  000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,
  000X,000X,000X,000X,000X,000X,000X,000X,000X,000X,009X,006X,
  003X,003X,021X,021X,00CX,00FX,012X,012X,015X,018X,01BX,003X,
  003X,021X,021X,00CX,00FX,012X,012X,015X,018X,01BX,01EX,024X,
  0FFX,033X,001X,0A6X,001X,009X,002X,0ACX,002X,0A6X,001X,01EX,
  003X,00DX,002X,0A6X,001X,07FX,002X,00DX,002X,0A6X,001X,009X,
  002X,0ACX,002X,0A6X,001X,033X,004X,0ACX,002X,0C9X,004X,033X,
  004X,02CX,005X,04BX,005X,033X,004X,002X,006X,04BX,005X,033X,
  004X,0AFX,006X,09CX,007X,033X,004X,0AFX,006X,0BFX,007X,033X,
  004X,0E7X,007X,0FBX,007X,01EX,008X,0ACX,002X,0A6X,001X,0A3X,
  003X,032X,008X,032X,008X,032X,008X,0F3X,008X,0CEX,009X,0B1X,
  002X,085X,006X,009X,087X,004X,009X,088X,006X,009X,08AX,004X,
  009X,08CX,006X,0C9X,009X,08AX,004X,009X,08CX,006X,0C8X,009X,
  08AX,004X,009X,08CX,006X,0C7X,009X,08AX,004X,009X,08CX,006X,
  0C6X,009X,08AX,004X,009X,08CX,006X,0C5X,009X,08AX,004X,009X,
  08CX,006X,0C4X,009X,08AX,004X,0CFX,009X,085X,006X,009X,087X,
  004X,009X,088X,006X,009X,08AX,004X,009X,08CX,006X,0C9X,009X,
  08AX,004X,009X,08CX,006X,0C8X,009X,08AX,004X,009X,08CX,006X,
  0C7X,009X,08AX,004X,009X,08CX,006X,0C6X,009X,08AX,004X,009X,
  08CX,006X,0C5X,009X,08AX,004X,009X,08CX,006X,0C4X,009X,08AX,
  004X,000X,0F0X,010X,0CFX,0B1X,005X,079X,0CAX,0B1X,001X,0D0X,
  0CFX,0B1X,005X,079X,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,079X,
  0CAX,0B1X,001X,0D0X,0CFX,0B1X,005X,077X,0CAX,0B1X,001X,0D0X,
  0CFX,0B1X,005X,077X,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,077X,
  0CAX,0B1X,001X,0D0X,0CFX,0B1X,005X,072X,0CAX,0B1X,001X,0D0X,
  0CFX,0B1X,005X,072X,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,072X,
  0CAX,0B1X,001X,0D0X,0CFX,0B1X,005X,074X,0CAX,0B1X,001X,0D0X,
  0CFX,0B1X,005X,074X,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,074X,
  0CAX,0B1X,001X,0D0X,000X,0B1X,040X,0D0X,000X,0F3X,008X,0CEX,
  009X,0B1X,002X,085X,006X,009X,087X,004X,009X,088X,006X,009X,
  08AX,004X,009X,08CX,006X,0C9X,009X,08AX,004X,009X,08CX,006X,
  0C8X,009X,08AX,004X,0CFX,009X,085X,006X,009X,087X,004X,009X,
  088X,006X,009X,08AX,004X,009X,08CX,006X,0C9X,009X,08AX,004X,
  009X,08CX,006X,0C8X,009X,08AX,004X,0CFX,009X,085X,006X,009X,
  087X,004X,009X,088X,006X,009X,08AX,004X,009X,08CX,006X,0C9X,
  009X,08AX,004X,009X,08CX,006X,0C8X,009X,08AX,004X,0CFX,009X,
  08CX,006X,009X,08AX,004X,009X,087X,006X,009X,083X,004X,009X,
  088X,006X,0C9X,009X,088X,004X,0CFX,009X,08FX,006X,0C9X,009X,
  08FX,004X,000X,0B1X,038X,0D0X,0F0X,010X,0CDX,0B1X,001X,06DX,
  001X,0D0X,001X,006X,000X,001X,0D0X,001X,006X,000X,001X,0D0X,
  001X,007X,000X,001X,0D0X,001X,007X,000X,001X,0D0X,001X,007X,
  000X,001X,0D0X,001X,006X,000X,001X,0D0X,001X,008X,000X,000X,
  0F3X,008X,0CEX,009X,0B1X,002X,08CX,006X,009X,08AX,004X,009X,
  088X,006X,009X,087X,004X,009X,085X,006X,0C9X,009X,087X,004X,
  009X,085X,006X,0C8X,009X,087X,004X,0CFX,009X,085X,006X,009X,
  087X,004X,009X,088X,006X,009X,08AX,004X,009X,08CX,006X,0C9X,
  009X,08AX,004X,009X,08CX,006X,0C8X,009X,08AX,004X,0CFX,009X,
  08CX,006X,009X,08AX,004X,009X,088X,006X,009X,087X,004X,009X,
  085X,006X,0C9X,009X,087X,004X,009X,085X,006X,0C8X,009X,087X,
  004X,0CFX,009X,08CX,006X,009X,08AX,004X,009X,087X,006X,009X,
  083X,004X,009X,088X,006X,0C9X,009X,088X,004X,0CFX,009X,08FX,
  006X,0C9X,009X,08FX,004X,000X,0F0X,008X,0CFX,0B1X,001X,061X,
  0CAX,0D0X,0CFX,061X,0CAX,0D0X,0CFX,06DX,0CAX,0D0X,0CFX,0B1X,
  003X,06DX,0CAX,0B1X,001X,0D0X,0CFX,061X,0CAX,0D0X,0CFX,06DX,
  0CAX,0D0X,0CFX,06DX,0CAX,0D0X,0CFX,05FX,0CAX,0D0X,0CFX,05FX,
  0CAX,0D0X,0CFX,06BX,0CAX,0D0X,0CFX,0B1X,003X,06BX,0CAX,0B1X,
  001X,0D0X,0CFX,05FX,0CAX,0D0X,0CFX,06BX,0CAX,0D0X,0CFX,06BX,
  0CAX,0D0X,0CFX,05AX,0CAX,0D0X,0CFX,05AX,0CAX,0D0X,0CFX,066X,
  0CAX,0D0X,0CFX,0B1X,003X,066X,0CAX,0B1X,001X,0D0X,0CFX,05AX,
  0CAX,0D0X,0CFX,066X,0CAX,0D0X,0CFX,066X,0CAX,0D0X,0CFX,05CX,
  0CAX,0D0X,0CFX,05CX,0CAX,0D0X,0CFX,068X,0CAX,0D0X,0CFX,0B1X,
  003X,068X,0CAX,0B1X,001X,0D0X,0CFX,05CX,0CAX,0D0X,0CFX,068X,
  0CAX,0D0X,0CFX,068X,0CAX,0D0X,000X,0F0X,008X,0CFX,0B1X,001X,
  061X,0CAX,0D0X,043X,0CFX,091X,0CAX,0D0X,040X,0CFX,06DX,0CAX,
  0D0X,0CFX,0B1X,002X,06DX,043X,091X,040X,0B1X,001X,061X,0CAX,
  0D0X,0CFX,06DX,0CAX,0D0X,0CFX,06DX,0CAX,0D0X,0CFX,05FX,0CAX,
  0D0X,043X,0CFX,0B1X,002X,091X,040X,0B1X,001X,06BX,0CAX,0D0X,
  0CFX,0B1X,002X,06BX,043X,091X,040X,0B1X,001X,05FX,0CAX,0D0X,
  0CFX,06BX,0CAX,0D0X,0CFX,06BX,0CAX,0D0X,0CFX,05AX,0CAX,0D0X,
  043X,0CFX,0B1X,002X,091X,040X,0B1X,001X,066X,0CAX,0D0X,0CFX,
  0B1X,002X,066X,043X,091X,040X,0B1X,001X,05AX,0CAX,0D0X,0CFX,
  066X,0CAX,0D0X,0CFX,066X,0CAX,0D0X,0CFX,05CX,0CAX,0D0X,043X,
  0CFX,0B1X,002X,08FX,040X,0B1X,001X,068X,0CAX,0D0X,0CFX,0B1X,
  002X,068X,043X,08FX,040X,0B1X,001X,05CX,0CAX,0D0X,0CFX,068X,
  0CAX,0D0X,0CFX,068X,0CAX,0D0X,000X,0F0X,008X,0CFX,0B1X,001X,
  061X,0CAX,0D0X,043X,0CFX,091X,0CAX,0D0X,040X,0CFX,06DX,0CAX,
  0D0X,0CFX,0B1X,002X,06DX,043X,091X,040X,0B1X,001X,061X,0CAX,
  0D0X,043X,0CFX,0B1X,002X,094X,040X,0B1X,001X,06DX,0CAX,0D0X,
  0CFX,05FX,0CAX,0D0X,043X,0CFX,091X,0CAX,0D0X,040X,0CFX,06BX,
  0CAX,0D0X,0CFX,0B1X,002X,06BX,043X,091X,040X,0B1X,001X,05FX,
  0CAX,0D0X,0CFX,06BX,0CAX,0D0X,0CFX,06BX,0CAX,0D0X,0CFX,05AX,
  0CAX,0D0X,043X,0CFX,0B1X,002X,091X,040X,0B1X,001X,066X,0CAX,
  0D0X,0CFX,0B1X,002X,066X,043X,091X,040X,0B1X,001X,05AX,0CAX,
  0D0X,043X,0CFX,0B1X,002X,094X,040X,0B1X,001X,066X,0CAX,0D0X,
  0CFX,05CX,0CAX,0D0X,043X,0CFX,0B1X,002X,08FX,040X,0B1X,001X,
  068X,0CAX,0D0X,0CFX,0B1X,002X,068X,043X,08FX,040X,0B1X,001X,
  05CX,0CAX,0D0X,0CFX,0B1X,002X,098X,0B1X,001X,068X,0CAX,0D0X,
  000X,0F0X,010X,0CFX,0B1X,005X,079X,0CAX,0B1X,001X,0D0X,0CFX,
  0B1X,005X,079X,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,079X,0CAX,
  0B1X,001X,0D0X,0CFX,0B1X,005X,07CX,0CAX,0B1X,001X,0D0X,0CFX,
  0B1X,005X,07CX,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,07CX,0CAX,
  0B1X,001X,0D0X,0CFX,0B1X,005X,07EX,0CAX,0B1X,001X,0D0X,0CFX,
  0B1X,005X,07EX,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,07EX,0CAX,
  0B1X,001X,0D0X,0CFX,0B1X,005X,080X,0CAX,0B1X,001X,0D0X,0CFX,
  0B1X,005X,080X,0CAX,0B1X,001X,0D0X,0CFX,0B1X,003X,080X,0CAX,
  0B1X,001X,0D0X,000X,0F3X,008X,0CFX,0B1X,004X,091X,096X,098X,
  0CAX,098X,0CFX,098X,096X,091X,0CAX,091X,0CFX,091X,094X,098X,
  0CAX,098X,0CFX,09BX,098X,094X,0B1X,002X,093X,094X,000X,0F0X,
  010X,0CFX,009X,0B1X,002X,079X,006X,009X,0D0X,004X,009X,0B1X,
  001X,0D0X,006X,0CAX,0D0X,0CFX,009X,0B1X,002X,079X,004X,009X,
  0D0X,006X,009X,0B1X,001X,0D0X,004X,0CAX,0D0X,0CFX,009X,0B1X,
  002X,079X,006X,009X,0B1X,001X,0D0X,004X,0CAX,0D0X,0CFX,009X,
  0B1X,002X,07CX,006X,009X,0D0X,004X,009X,0B1X,001X,0D0X,006X,
  0CAX,0D0X,0CFX,009X,0B1X,002X,07CX,004X,009X,0D0X,006X,009X,
  0B1X,001X,0D0X,004X,0CAX,0D0X,0CFX,009X,0B1X,002X,07CX,006X,
  009X,0B1X,001X,0D0X,004X,0CAX,0D0X,0CFX,009X,0B1X,002X,07EX,
  006X,009X,0D0X,004X,009X,0B1X,001X,0D0X,006X,0CAX,0D0X,0CFX,
  009X,0B1X,002X,07EX,004X,009X,0D0X,006X,009X,0B1X,001X,0D0X,
  004X,0CAX,0D0X,0CFX,009X,0B1X,002X,07EX,006X,009X,0B1X,001X,
  0D0X,004X,0CAX,0D0X,0CFX,009X,0B1X,002X,080X,006X,009X,0D0X,
  004X,009X,0B1X,001X,0D0X,006X,0CAX,0D0X,0CFX,009X,0B1X,002X,
  080X,004X,009X,0D0X,006X,009X,0B1X,001X,0D0X,004X,0CAX,0D0X,
  0CFX,009X,0B1X,002X,080X,006X,009X,0B1X,001X,0D0X,004X,0CAX,
  0D0X,000X,0F3X,008X,0CFX,0B1X,002X,091X,040X,0B1X,001X,06DX,
  0CAX,0D0X,043X,0CFX,0B1X,002X,096X,040X,0B1X,001X,06DX,0CAX,
  0D0X,043X,0CFX,0B1X,002X,098X,040X,0B1X,001X,079X,0CAX,0D0X,
  043X,0B1X,002X,098X,040X,0CFX,0B1X,001X,074X,0CAX,0D0X,043X,
  0CFX,0B1X,002X,098X,040X,0B1X,001X,06DX,0CAX,0D0X,043X,0CFX,
  0B1X,002X,096X,040X,0B1X,001X,06DX,0CAX,0D0X,043X,0CFX,0B1X,
  002X,091X,040X,0B1X,001X,079X,0CAX,0D0X,043X,0B1X,002X,091X,
  040X,0CFX,0B1X,001X,074X,0CAX,0D0X,043X,0CFX,0B1X,002X,091X,
  040X,0B1X,001X,06DX,0CAX,0D0X,043X,0CFX,0B1X,002X,094X,040X,
  0B1X,001X,06DX,0CAX,0D0X,043X,0CFX,0B1X,002X,098X,040X,0B1X,
  001X,079X,0CAX,0D0X,043X,0B1X,002X,098X,040X,0CFX,0B1X,001X,
  074X,0CAX,0D0X,043X,0CFX,0B1X,002X,09BX,040X,0B1X,001X,06DX,
  0CAX,0D0X,043X,0CFX,0B1X,002X,098X,040X,0B1X,001X,06DX,0CAX,
  0D0X,043X,0CFX,0B1X,002X,094X,040X,0B1X,001X,079X,0CAX,0D0X,
  043X,0CFX,0B1X,002X,093X,094X,000X,0F3X,008X,0CFX,009X,0B1X,
  002X,091X,006X,040X,009X,0B1X,001X,06DX,004X,0CAX,0D0X,043X,
  0CFX,009X,0B1X,002X,096X,006X,040X,009X,0B1X,001X,06DX,004X,
  0CAX,0D0X,043X,0CFX,009X,0B1X,002X,098X,006X,040X,009X,0B1X,
  001X,079X,004X,0CAX,0D0X,043X,009X,0B1X,002X,098X,006X,040X,
  0CFX,009X,0B1X,001X,074X,004X,0CAX,0D0X,043X,0CFX,009X,0B1X,
  002X,098X,006X,040X,009X,0B1X,001X,06DX,004X,0CAX,0D0X,043X,
  0CFX,009X,0B1X,002X,096X,006X,040X,009X,0B1X,001X,06DX,004X,
  0CAX,0D0X,043X,0CFX,009X,0B1X,002X,091X,006X,040X,009X,0B1X,
  001X,079X,004X,0CAX,0D0X,043X,009X,0B1X,002X,091X,006X,040X,
  0CFX,009X,0B1X,001X,074X,004X,0CAX,0D0X,043X,0CFX,009X,0B1X,
  002X,091X,006X,040X,009X,0B1X,001X,06DX,004X,0CAX,0D0X,043X,
  0CFX,009X,0B1X,002X,094X,006X,040X,009X,0B1X,001X,06DX,004X,
  0CAX,0D0X,043X,0CFX,009X,0B1X,002X,098X,006X,040X,009X,0B1X,
  001X,079X,004X,0CAX,0D0X,043X,009X,0B1X,002X,098X,006X,040X,
  0CFX,009X,0B1X,001X,074X,004X,0CAX,0D0X,043X,0CFX,009X,0B1X,
  002X,09BX,006X,040X,009X,0B1X,001X,06DX,004X,0CAX,0D0X,043X,
  0CFX,009X,0B1X,002X,098X,006X,040X,009X,0B1X,001X,06DX,004X,
  0CAX,0D0X,043X,0CFX,009X,0B1X,002X,094X,006X,040X,009X,0B1X,
  001X,079X,004X,0CAX,0D0X,043X,0CFX,009X,0B1X,002X,093X,006X,
  009X,094X,004X,000X,0F0X,008X,0CFX,0B1X,004X,06DX,079X,0B1X,
  008X,077X,0B1X,004X,06DX,079X,0B1X,008X,077X,0B1X,004X,06DX,
  079X,0B1X,008X,077X,0B1X,004X,06DX,079X,0B1X,006X,077X,0B1X,
  002X,074X,000X,0F0X,008X,0CFX,0B1X,004X,06DX,079X,0B1X,008X,
  077X,0B1X,004X,06DX,079X,0B1X,008X,077X,0B1X,004X,06DX,079X,
  0B1X,008X,077X,043X,0CEX,0B1X,002X,08CX,08AX,087X,083X,088X,
  0CAX,088X,0CFX,08FX,0CAX,08FX,000X,0F3X,008X,0CFX,0B1X,002X,
  08CX,0C9X,08CX,0C7X,08CX,0C5X,08CX,0C3X,08CX,0C2X,08CX,0C1X,
  08CX,0C0X,000X,0F0X,010X,0CBX,009X,0B1X,002X,079X,006X,0C9X,
  009X,079X,004X,0C7X,009X,079X,006X,0C5X,009X,079X,004X,0C3X,
  009X,079X,006X,0C1X,009X,079X,004X,009X,0C0X,006X,009X,0D0X,
  004X,000X,0F0X,008X,0CFX,0B1X,002X,061X,0C9X,061X,0C7X,061X,
  0C5X,061X,0C3X,061X,0C2X,061X,0C1X,061X,0C0X,000X,0B1X,004X,
  0D0X,000X,003X,005X,001X,08FX,000X,000X,001X,08FX,000X,000X,
  001X,08FX,000X,000X,001X,08DX,000X,000X,081X,08DX,000X,000X,
  000X,001X,000X,08DX,000X,000X,000X,001X,000X,001X,002X,00CX,
  000X);

BEGIN
  B.Init;
  Pt3Player.Init(Ace);

  Asm.Code("play_l$: LD   IY,#0x5C3A");
  Asm.Code("         EI             ");
  Asm.Code("         HALT           ");

  Pt3Player.Play;

  Asm.Code("         LD   A,#0x7F   ");
  Asm.Code("         IN   A,(-2)    ");
  Asm.Code("         RRA            ");
  Asm.Code("         JR   C,play_l$ ");

  Pt3Player.Mute;
  B.Quit;
END TestPT3.
